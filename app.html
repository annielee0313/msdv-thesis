<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fluid Notes Visualization</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://use.typekit.net/ina4ngi.css">
</head>
<body>
    <div id="container">
        <div id="fixed-top">
            <div id="fixed-top-layout">
              <!-- LEFT: Summary + Ads -->
              <div class="left-column">
                
                
                <div id="era-display" class="era-container">
                  <div class="title-label">
                    <img src="assets/logo.svg" alt="Fluidnotes" class="fluidnotes-logo" id="about-button">

                    <!-- toggle component -->
                    <div class="explore-toggle">
                      <span class="explore-label"></span>
                      <div class="toggle-container">
                        <button class="toggle-btn active" data-mode="notes">Notes</button>
                        <button class="toggle-btn" data-mode="ads">Ads</button>
                      </div>
                    </div>
                  </div>
                  
                  
                  <div class="era-title"></div>
                  <div class="era-years"></div>
                  <!-- <div class="era-gender-label">Gender Approach:</div> -->
                  <div class="era-gender-approach"></div>
                  <div class="era-description"></div>
                  
                  <div class="era-navigation">
                    <button class="nav-btn prev-era" aria-label="Previous era">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15 18L9 12L15 6" stroke="#3A3A3A" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </button>
                    
                    <div class="era-progress-bar">
                      <div class="era-segment" data-start-year="1900" data-end-year="1949" data-era="Idealized Femininity">
                        <div class="segment-fill"></div>
                      </div>
                      <div class="era-segment" data-start-year="1950" data-end-year="1989" data-era="Binary Boom">
                        <div class="segment-fill"></div>
                      </div>
                      <div class="era-segment" data-start-year="1990" data-end-year="2009" data-era="Fluidity Emerges">
                        <div class="segment-fill"></div>
                      </div>
                      <div class="era-segment" data-start-year="2010" data-end-year="2025" data-era="Age of Expression">
                        <div class="segment-fill"></div>
                      </div>
                    </div>
                    
                    <button class="nav-btn next-era" aria-label="Next era">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 18L15 12L9 6" stroke="#3A3A3A" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </button>
                  </div>
                  
                </div> 
              </div>
              
              <!-- RIGHT SECTION WRAPPER (includes controls + columns) -->
              <div class="right-section">
                
                <!-- COLUMNS CONTAINER -->
                <div class="columns-container">
                  <!-- MIDDLE: Year + Notes Graph -->
                  <div class="middle-column">
                    <div class="chart-label">Fragrance Releases</br> By Gender</div>
                    <div id="pie-chart-tooltip"></div>
                    <div class="pie-chart-wrapper">
                      <svg id="pie-chart" width="160" height="160"></svg>
                    </div>

                    <!-- legend here -->
                    <div class="gender-legend">
                      <div class="legend-item">
                        <span class="legend-color" style="background-color: #E9D7E4;"></span>
                        <span class="legend-text">Women</span>
                      </div>
                      <div class="legend-item">
                        <span class="legend-color" style="background-color: #C4CDF4;"></span>
                        <span class="legend-text">Men</span>
                      </div>
                      <div class="legend-item">
                        <span class="legend-color" style="background-color: #6D7084;"></span>
                        <span class="legend-text">Unisex</span>
                      </div>
                    </div>
                    

                    <!-- <div id="grid-tooltip" class="tooltip"></div>
                    <div class="chart-label-2">Notes Mosaic</div> 
                    <svg id="notes-graph"></svg>      -->
                  </div>
                
                  <!-- RIGHT: Bar Chart -->
                  <div class="right-column">
                    <!-- Add title with new class -->
                    <div class="stacked-bar-title">Top 10 Notes: Gender Distribution and Popularity Trend</div>

                        <!-- CONTROLS ROW - Now above both middle and right columns -->
                        <div class="controls-row">
                          <!-- COMBINED FILTERS IN ONE ROW -->
                          <div class="filter-row">
                            <!-- GENDER DROPDOWN -->
                            <div class="filter-group dropdown">
                              <select id="gender-filter" class="filter-select">
                                <option value="all">All</option>
                                <option value="women">Women</option>
                                <option value="unisex">Unisex</option>
                                <option value="men">Men</option>
                              </select>
                              <span class="filter-label">Gender</span>
                            </div>
                            
                            <!-- NOTES DROPDOWN -->
                            <div class="filter-group dropdown">
                              <select id="notes-filter" class="filter-select">
                                <option value="all">All</option>
                                <option value="top">Top</option>
                                <option value="middle">Middle</option>
                                <option value="base">Base</option>
                              </select>
                              <span class="filter-label">Notes</span>
                            </div>
                            
                            <!-- SEARCH BAR -->
                            <div class="filter-group search">
                              <span class="filter-label">Search</span>
                              <input type="text" id="note-search" class="search-input" placeholder="Search for Notes..." />
                            </div>
                          </div>
                        </div>

                    <div id="bar-chart-tooltip"></div>
                    <svg id="stacked-bar-chart"></svg>
                  </div>
                </div>
              </div>
              
              <!-- Ads Right Section -->
              <div class="ads-right-section" style="display: none;">
                <!-- Treemap Row -->
                <div class="treemap-row">
                  
                  <div class="treemap-wrapper" data-gender="women">
                    <div class="treemap-title">Women's Ads</div>
                    <div class="breadcrumb" id="breadcrumb-women">Visual Subject</div>
                    <button class="back-button" id="back-button-women">←</button>
                    <svg id="treemap-women" width="100%" height="180"></svg>
                  </div>
                  <div class="treemap-wrapper" data-gender="men">
                    <div class="treemap-title">Men's Ads</div>
                    <div class="breadcrumb" id="breadcrumb-men">Visual Subject</div>
                    <button class="back-button" id="back-button-men">←</button>
                    <svg id="treemap-men" width="100%" height="180"></svg>
                  </div>
                  <div class="treemap-wrapper" data-gender="unisex">
                    <div class="treemap-title">Unisex Ads</div>
                    <div class="breadcrumb" id="breadcrumb-unisex">Visual Subject</div>
                    <button class="back-button" id="back-button-unisex">←</button>
                    <svg id="treemap-unisex" width="100%" height="180"></svg>
                  </div>
                </div>
                
                <div id="treemap-tooltip" class="tooltip"></div>

                <!-- Gallery Section - keeping just the container as requested -->
                <div class="gallery-section">
                  <!-- Add this new title div -->
                  <div class="gallery-header">
                    <div class="gallery-title" id="gallery-title"></div>
                  </div>
                  
                  <!-- Keep the existing gallery container -->
                  <div class="gallery-row">
                    <div class="gallery-container" id="gallery-container">
                      
                    </div>
                  </div>
                </div>
              </div>
              
            </div>
          </div>
      
        <div id="scroll-section">
          <div id="scroll-outer">
            <div id="scroll-inner">
              <!-- dynamically injected year steps go here -->
            </div>
          </div>
        </div>
      </div>

      <div id="milestone-container">
        <div id="milestone-box" class="hidden">
          <div id="milestone-title"></div>
          <div id="milestone-subtitle"></div>
        </div>
      </div>

      <div id="ad-preview-container" class="hidden"></div>
      <div id="ad-preview-box" class="hidden">
        <img id="ad-preview-img" src="" />
        <div id="ad-preview-text"></div>
      </div>
      
      <!-- About overlay HTML -->
      <div id="about-overlay" class="about-overlay hidden">
        <div class="about-container">
          <button id="close-about" class="close-about">×</button>
          <h2 class="about-title">About the Project</h2>
          <div class="about-content">
            <p>Fluid Notes is an interactive data visualization that traces how perfume has reflected and reshaped gender norms over the past century. Using data from over 25,000 perfumes and 200 vintage ads, the project explores shifting scent trends, marketing language, and gender categories — revealing that fragrance, like gender, is fluid and evolving.</p>
            
            <div class="about-footer">
              <p>2025 MS Data Visualization Thesis Project by <a href="https://ayynniee.com/" target="_blank" rel="noopener" class="author-link">Annie Lee</a></p>
            </div>
          </div>
        </div>
      </div>

      <!-- Ad Details Modal -->
      <div id="ad-detail-modal" class="ad-detail-modal hidden">
        <div class="ad-detail-container">
          <div class="ad-detail-content">
            <div class="ad-detail-left">
              <img id="ad-detail-image" src="" alt="Advertisement">
            </div>
            <div class="ad-detail-right">
              <div class="ad-detail-title-container">
                <div id="ad-detail-title"></div>
                <a id="ad-external-link" href="#" target="_blank" rel="noopener noreferrer" class="ad-external-link hidden">
                </a>
              </div>
              <div id="ad-detail-info"></div>
              <div id="ad-detail-copy"></div>
              
              <div class="notes-section">
                <div class="ad-scent-profile">Scent Profile</div>
                <div class="notes-row">
                  <!-- Removed labels per request -->
                  <div id="top-notes-row" class="notes-container"></div>
                </div>
                <div class="notes-row">
                  <!-- Removed labels per request -->
                  <div id="middle-notes-row" class="notes-container"></div>
                </div>
                <div class="notes-row">
                  <!-- Removed labels per request -->
                  <div id="base-notes-row" class="notes-container"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="note-tooltip" class="note-tooltip hidden"></div>
      </div>

      <div id="note-detail-modal" class="note-detail-modal hidden">
        <div class="note-detail-container">
          <div class="note-detail-content">
            <h2 id="note-detail-title"></h2>
            <div id="note-detail-info"></div>
            <div id="note-detail-description"></div>
          </div>
        </div>
      </div>

  <!-- Add this script before your other scripts -->
  <script>
    // Detect if we're on GitHub Pages and set the base path accordingly
    const isGitHubPages = window.location.hostname === 'annielee0313.github.io';
    const basePath = isGitHubPages ? '/msdv-thesis' : '';
    
    // Create a function to dynamically fix all fetch/resource URLs
    window.getCorrectPath = function(path) {
      // If the path already starts with the base path or is an absolute URL, return it as is
      if (path.startsWith(basePath) || path.startsWith('http') || path.startsWith('//')) {
        return path;
      }
      
      // If path starts with '/', ensure we don't double up slashes
      if (path.startsWith('/')) {
        return `${basePath}${path}`;
      }
      
      // For relative paths
      return `${basePath}/${path}`;
    }
    
    // Override fetch to automatically fix URLs
    const originalFetch = window.fetch;
    window.fetch = function(url, options) {
      return originalFetch(window.getCorrectPath(url), options);
    };
  </script>

  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script type="module" src="./js/adDetailModal.js"></script>
  <script type="module" src="./js/adsTreemap.js"></script>
  <script src="https://unpkg.com/scrollama"></script>
  <script type="module" src="./js/main.js"></script>
  <script src="./js/dropdown.js"></script>
  <script src="./js/toggleView.js"></script>
  <script src="./js/eraNavigation.js"></script>
  <script src="./js/aboutOverlay.js"></script>
  

  <svg style="display: none;">
    <filter id="paper-texture">
      <feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="4" stitchTiles="stitch"/>
      <feColorMatrix type="saturate" values="0"/>
      <feComponentTransfer>
        <feFuncR type="linear" slope="0.3"/>
        <feFuncG type="linear" slope="0.3"/>
        <feFuncB type="linear" slope="0.3"/>
      </feComponentTransfer>
    </filter>
  </svg>
</body>
</html>
